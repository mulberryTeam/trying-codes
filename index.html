<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mulberry Store</title>
  <!-- Google Fonts for general text -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Montserrat:wght@700&display=swap" rel="stylesheet" />
  <!-- Orbitron for the store name and interface (Orbitron Black: weight 900) -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap" rel="stylesheet"/>
  <!-- Tristan Font for the store name (not used for store name now) -->
  <link href="https://fonts.cdnfonts.com/css/tristan" rel="stylesheet"/>
  <!-- FontAwesome for potential extra icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-pVnKp3yY4kSg+2e1ZxZ9XrpYB0+8L2TNnpqmKEz7qR3V7tUj3+npBbTzvn4jn/Es9vXbm2hCk2wFVu8jz0a8Ug==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  
  <style>



.product-buttons-container {
  display: flex;
  gap: 20px;               /* مسافة بين الأزرار */
  justify-content: center; /* محاذاة الأزرار في الوسط */
  flex-wrap: wrap;         /* لفّ الأزرار على عدة أسطر إذا ضاقت المساحة */
}

.product-button {
  position: relative;
  width: 160px;            /* عرض الزر */
  height: 160px;           /* ارتفاع الزر */
  border-radius: 20px;     /* زوايا منحنية */
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* ظل خفيف حول الزر */

  overflow: hidden;
  text-decoration: none;   /* إزالة التسطير الافتراضي للروابط */
  display: flex;
  flex-direction: column;
  align-items: center;
}

.product-button .img-wrapper {
  flex: 1;
  width: 100%;
  background-size: cover;
  background-position: center;
}

.product-button .img-wrapper::before {
  content: "";
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(255, 255, 255, 0.3); /* طبقة بيضاء شفافة 30% */
}

.product-button .btn-label {
  margin-top: 10px;
  font-weight: bold;
  font-size: 1.1rem;
  color: #fff;             /* اختر اللون الذي يناسب تصميمك */
}










    :root {
      --primary-color: #0000cd; /* Blue */
      --secondary-color: #800080; /* Purple */
      --accent-order: #8b0000; /* Dark red */
      --accent-language-1: #3aa56f;
      --accent-language-2: #48c987;
      --accent-join-1: #ff85c5;
      --accent-join-2: #ff3bae;
      --text-color: #333;
      --heading-color: #222;
      --background-gradient: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
      --button-bg: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
      --header-bg: transparent;
      --body-font: 'Poppins', sans-serif;
      --extra-font: 'Montserrat', sans-serif;
      
      /* Light Mode Colors */
      --body-bg-color: var(--background-gradient);
      --page-text-color: #333;
      
      /* Dark Mode Colors */
      --dark-body-bg: #1a1a1a;
      --dark-heading-bg: #2b2b2b;
      --dark-text-color: #eee;
      --dark-button-bg: linear-gradient(45deg, #2e2e8b, #40007a);
    }
    
    html.dark-mode {
      --body-bg-color: var(--dark-body-bg) !important;
      --page-text-color: var(--dark-text-color) !important;
      --header-bg: var(--dark-heading-bg) !important;
      --button-bg: var(--dark-button-bg) !important;
    }
    
    /* Full-screen Background Video */
    #backgroundVideo {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      object-fit: cover;
      z-index: -2;
      filter: brightness(0.75) contrast(1.2);
    }
    
    /* Full-screen Overlay */
    #overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(75, 0, 130, 0.4);
      z-index: -1;
    }
    
    /* Loader Overlay for initial page load */
    #loader {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      transition: opacity 0.5s ease;
    }
    .spinner {
      border: 8px solid #f3f3f3;
      border-top: 8px solid var(--secondary-color);
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Global button styles */
    button {
      cursor: pointer;
      transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55),
                  box-shadow 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }
    button:active { animation: bounce 0.2s; }
    @keyframes bounce {
      0% { transform: scale(1); }
      50% { transform: scale(0.95); }
      100% { transform: scale(1); }
    }
    
    /* Body */
    body {
      margin: 0;
      padding: 0;
      font-family: var(--body-font);
      direction: rtl;
      text-align: center;
      background: var(--body-bg-color);
      background-size: 400% 400%;
      animation: gradientAnimation 10s ease infinite;
      color: var(--page-text-color);
      transition: background 0.4s, color 0.4s;
    }
    @keyframes gradientAnimation {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    .gpd-section {
      padding: 20px 0;
      position: relative;
      width: 100%;
      box-sizing: border-box;
    }
    .gpd-container {
      width: 90%;
      margin: 0 auto;
      max-width: 1200px;
      position: relative;
    }
    .gdp-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      margin: 0 -15px;
    }
    .cell {
      padding: 0 15px;
      box-sizing: border-box;
      flex: 1;
      margin-bottom: 20px;
    }
    
    /* Header (elements directly on the background, fixed at top) */
    #headerSection {
      display: flex;
      background: none;
      padding: 10px 0;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 999;
    }
    #headerContent {
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
    }
    #headerContent .header-left,
    #headerContent .header-center,
    #headerContent .header-right {
      display: flex;
      align-items: center;
    }
    #headerContent .header-left { justify-content: flex-start; }
    .social-icons {
      display: flex;
      gap: 10px;
      margin-left: 10px;
      align-items: center;
    }
    .social-btn {
      display: inline-flex;
      justify-content: center;
      align-items: center;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      text-decoration: none;
      transition: transform 0.3s;
    }
    .social-btn:hover { transform: scale(1.1); }
    .social-btn.instagram {
      background: linear-gradient(45deg, #833ab4, #c13584);
      border: 1px solid #833ab4;
    }
    .social-btn.facebook {
      background: #1877f2;
      border: 1px solid #1877f2;
    }
    .social-btn.tiktok {
      background: #fff;
      border: 1px solid var(--secondary-color);
      color: var(--secondary-color);
    }
    .social-btn img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
    
    .contact-info {
      font-size: 13px;
      color: #fff;
      margin: 0 10px;
      line-height: 1.2;
      text-align: left;
    }
    
    /* Store logo replaces the store name in the center */
    #storeLogo {
      max-height: 50px;
    }
    
    #headerContent .header-right {
      justify-content: flex-end;
      gap: 8px;
      margin-right: 10px;
    }
    #headerContent button {
      background: var(--button-bg);
      border: none;
      color: #fff;
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 13px;
      transition: transform 0.3s, background 0.4s;
      font-family: var(--extra-font);
    }
    #headerContent button:hover { transform: scale(1.05); }
    
   
    
    /* Order Products Button - تم تغيير النص داخل الزر إلى "اطلب استشارة" */
    #orderProductsBtn {
      background: red !important;
      background-color: red !important;
      background-image: none !important;
      border: 2px solid red !important;
      border-radius: 16px;
      color: #fff;
      padding: 6px 12px;
      font-size: 13px;
      transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      font-family: var(--extra-font);
    }
    #orderProductsBtn:hover { transform: scale(1.08); }
    
    /* Dark Mode Button with round white background at 50% transparency */
    #darkModeBtn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 45px;
      height: 45px;
      background: rgba(255, 255, 255, 0.5);
      border: none;
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.3s;
      z-index: 9999;
    }
    #darkModeImg {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 50%;
    }
    
    /* Main content below header */
    main { padding-top: 100px; }
    
    /* Landing Section */
    #landingSection {
      margin-bottom: 20px;
      position: relative;
      border-radius: 15px;
      overflow: hidden;
    }
    #landing {
      position: relative;
      z-index: 2;
      padding: 60px;
      text-align: center;
    }
    #landing h1 {
      font-size: 3.5em;
      margin-bottom: 25px;
      color: #fff;
      font-weight: 900;
      font-family: 'Orbitron', sans-serif;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
    }
    .phrase {
      font-family: var(--body-font);
      font-style: italic;
      margin: 10px 0;
margin-top: 0;
 margin-bottom: 15px;
      color: #fff;
      font-size: 1;
      font-weight: 600;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
    }
    .description {
      text-align: justify;
      line-height: 1.8;
      margin-top: 30px;
      color: #fff;
      font-size: 1.2em;
      letter-spacing: 0.7px;
      font-weight: 600;
      font-family: var(--extra-font);
      text-shadow: 1px 1px 3px rgba(0,0,0,0.7);
    }
    
    #shopNow:hover { transform: scale(1.05); }
    
    /* Extended Sections (Products Display) */
    #sectionsSection {
      display: none;
      background: #fff;
      border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      margin-bottom: 40px;
      transition: background 0.4s, color 0.4s;
    }
    #sections { padding: 20px; }
    #sections .back-container {
      text-align: left;
      margin-bottom: 10px;
    }
    #sections .back-container button {
      background: none;
      border: none;
      cursor: pointer;
    }
    #sections .back-container button svg {
      width: 30px;
      height: 30px;
      fill: var(--primary-color);
    }
    #searchContainer {
      margin-top: 20px;
      margin-bottom: 20px;
    }
    /* شريط التبويبات للأقسام الثابتة والديناميكية مع شريط تمرير أعلى */
    #tabs-wrapper {
      overflow-x: auto;
      margin-bottom: 20px;
      transform: rotateX(180deg);
    }
    #tabs {
      display: flex;
      flex-wrap: nowrap;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      transform: rotateX(180deg);
    }
    
    #tabs .tab {
      background: transparent;
      border: 2px solid var(--primary-color);
      color: var(--primary-color);
      padding: 10px 20px;
      margin: 0 5px;
      cursor: pointer;
      border-radius: 8px;
      font-size: 16px;
      transition: background 0.3s, color 0.3s;
      font-family: var(--body-font);
      flex: 0 0 auto;
    }
    #tabs .tab.active,
    #tabs .tab:hover {
      background: var(--secondary-color);
      color: #fff;
    }
    #sectionContent .section-group { display: none; }
    #sectionContent .section-group.active {
      display: block;
      animation: fadeInNav 0.5s ease;
    }
    @keyframes fadeInNav {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    /* يتم هنا عرض المنتجات داخل الحاويات */
    .section-buttons {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
    }
    
    /* تصميم زر القسم الأصلي (في حال كان عرض الأقسام) */
    .section-button {
      position: relative;
      width: 130px;
      height: 130px;
      border-radius: 15px;
      overflow: hidden;
      cursor: pointer;
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
      transition: transform 0.3s;
    }
    .section-button:hover { transform: translateY(-3px); }
    .section-button .bg-image {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
    }
    .section-button .overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,139,0.5);
    }
    .section-button .text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-weight: bold;
      color: #fff;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.7);
      text-align: center;
      padding: 5px;
      font-size: 24px;
      letter-spacing: 2px;
      font-family: var(--extra-font);
    }
    
    /* تصميم بطاقة المنتج */
    .product-card {
      border: 1px solid #ddd;
      border-radius: 8px;
      overflow: hidden;
      padding: 10px;
      margin: 10px;
      text-align: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      transition: transform 0.3s;
      background-color: #fff;
      width: 200px;
    }
    .product-card img {
      width: 100%;
      height: auto;
      max-height: 150px;
      object-fit: contain;
    }
    .product-card h3 {
      font-size: 16px;
      margin: 10px 0 5px;
      font-family: var(--extra-font);
    }
    .product-card p {
      font-size: 14px;
      color: #333;
      margin: 5px 0;
    }
    .product-card:hover {
      transform: scale(1.03);
    }
    
    #extendedInfo {
      margin-top: 40px;
      background: #fff;
      padding: 20px;
      border-radius: 15px;
      text-align: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      transition: background 0.4s, color 0.4s;
    }
    #extendedInfo p {
      margin: 10px 0;
      font-size: 1em;
      line-height: 1.8;
      font-weight: bold;
      color: var(--text-color);
      font-family: var(--body-font);
    }
    
    #smartSearch {
      width: 80%;
      max-width: 500px;
      padding: 12px 15px;
      font-size: 16px;
      border: 2px solid var(--primary-color);
      border-radius: 25px;
      outline: none;
      transition: border-color 0.3s;
    }
    #smartSearch:focus { border-color: var(--secondary-color); }
    #searchResults {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
    }
    
    .modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,139,0.8);
    }
    /* قواعد عامة للمودال */
    .modal-content {
      background-color: #fff;
      border-radius: 15px;
      padding: 20px;
      position: relative;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      animation: fadeIn 0.5s;
      color: var(--text-color);
      font-family: var(--body-font);
      transition: background 0.4s, color 0.4s;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }
    .modal-content iframe {
      width: 100%;
      height: 500px;
      border: none;
      border-radius: 8px;
    }
    .close {
      color: #aaa;
      cursor: pointer;
      font-size: 24px;
      position: absolute;
      top: 10px;
      right: 20px;
      transition: color 0.3s;
    }
    .close:hover { color: #000; }
    .close-btn {
      margin-top: 10px;
      padding: 8px 20px;
      background: var(--button-bg);
      color: #fff;
      border: none;
      border-radius: 8px;
      transition: transform 0.3s;
      font-family: var(--extra-font);
    }
    .close-btn:hover { transform: scale(1.05); }
    
    /* Modal Loader for popup iframe */
    #modalLoader {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255,255,255,0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
    }
    #modalLoader .spinner {
      border: 8px solid #f3f3f3;
      border-top: 8px solid var(--secondary-color);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
    }
    
    /* تعديل خاص بنموذج عجلة الحظ */
    /* نجعل مودال عجلة الحظ يظهر في وسط الشاشة باستخدام Flexbox */
    #luckyWheelModal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,139,0.8);
      align-items: center;
      justify-content: center;
      z-index: 2100;
    }
    /* إزالة الهامش الافتراضي للمحتوى داخل مودال عجلة الحظ */
    #luckyWheelModal .modal-content {
      margin: 0;
    }
    /* على جميع الأجهزة، يتم عرض شاشة عجلة الحظ بحجم ثابت 781×667 */
    @media (min-width: 768px) {
      #luckyWheelModal .modal-content {
        width: 781px;
        height: 667px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
      #luckyWheelModal .modal-content iframe {
        width: 100%;
        height: calc(100% - 50px); /* تخصيص مساحة للزر */
      }
    }
    @media (max-width: 767px) {
      #luckyWheelModal .modal-content {
        width: 781px;
        height: 667px;
        max-width: 100%;
        max-height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
      #luckyWheelModal .modal-content iframe {
        width: 100%;
        height: calc(100% - 50px);
      }
    }
    /* زر الإغلاق الخاص بعجلة الحظ */
    #luckyWheelModal .close-lucky-btn {
      background-color: #8b0000;
      border: none;
      color: #fff;
      padding: 8px 12px;
      margin-top: 10px;
      border-radius: 4px;
      font-size: 14px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
    }






    
    /* تكبير أيقونة زر عجلة الحظ على الجوال بنسبة *4 */
    @media (max-width: 767px) {
      #luckyWheelBtn img {
        transform: scale(4) !important;
      }
    }
    
    /* DARK MODE Overrides */
    html.dark-mode #sectionsSection {
      background: #000;
      color: #fff;
    }
    html.dark-mode #smartSearch {
      background: #000;
      color: #fff;
    }
    html.dark-mode #smartSearch::placeholder {
      color: #fff;
    }
    
    /* تعديلات خاصة بأجهزة الحاسوب والشاشات الكبيرة */
    @media (min-width: 1024px) {
      /* زيادة حجم زر عجلة الحظ على الشاشات الكبيرة */
      #luckyWheelBtn {
        width: 60px !important;
        height: 60px !important;
      }
      /* ضبط حجم شاشة عجلة الحظ لتظهر بشكل متناسق وواضح على الحاسوب (اصغر حجماً) */
      #luckyWheelModal .modal-content {
        width: 700px;
        height: 600px;
      }
    }



/* رفع العنوان والنصوص فوق الأزرار */
.section-title {
  margin-top: 10px;    /* قلّلت المساحة العلوية للرفع */
  margin-bottom: 5px;  /* قلّلت المساحة السفلية */
font-size: 1rem;
}

/* رفع مجموعة الأزرار نحو الأعلى */
.product-buttons-container {
  margin-top: -15px;   /* قيمة سالبة لرفع الأزرار؛ جرّب -10px أو -30px للوصول للموضع الأمثل */
}




@media (max-width: 768px) {
  .product-buttons-container {
    display: flex;
    width: 100%;                   /* عرض الحاوية كامل الشاشة */
    padding: 0;                    /* إزالة أي حشوة جانبية */
    justify-content: space-between;/* يوزّع الأزرار من طرف لطرف */
    gap: 4px;                      /* مسافة صغيرة ثابتة بين الأزرر */
    box-sizing: border-box;        /* لتضمين الهامش والحشوة ضمن الـ 100% */
  }

  .product-button {
    flex: 1.2;                     /* كل زر يكبر بنسبة 1.2 فليكسيبل */
    margin: 0;                     /* لا هامش إضافي */
    aspect-ratio: 0.50;               /* يحافظ على المربع */
    max-width: none;               /* يلغي أية حدود عرض سابقة */
  }
.product-button span {
    font-size: 12px !important; /* يمكنك التعديل مثلاً 11px أو 10px حسب ما يناسبك */
  }
}












  </style>
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
  <script>
    // تكوين Firebase (نفس الإعدادات القديمة)
    const firebaseConfig = {
      apiKey: "AIzaSyAi3_y7ugKB0cgzMV1-IVvbE2BwG_9RKSs",
      authDomain: "team-analysis-3c196.firebaseapp.com",
      databaseURL: "https://team-analysis-3c196-default-rtdb.firebaseio.com",
      projectId: "team-analysis-3c196",
      storageBucket: "team-analysis-3c196.firebasestorage.app",
      messagingSenderId: "38968485922",
      appId: "1:38968485922:web:667832a4aa77599ba8a6fb",
      measurementId: "G-853WkH2JK7"
    };

    // تهيئة Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // أمثلة على وظائف الكتابة والقراءة من قاعدة البيانات
    function writeUserData(userId, name, email) {
      firebase.database().ref('users/' + userId).set({
        username: name,
        email: email
      });
    }

    function readUserData(userId) {
      const userRef = firebase.database().ref('users/' + userId);
      userRef.on('value', (snapshot) => {
        const data = snapshot.val();
        console.log(data);
      });
    }




window.onload = function() {
  

document.getElementById("popularPerfumesBtn").addEventListener("click", function(e) {
  e.preventDefault();
  // إخفاء الـ Landing Section وإظهار الـ Sections Section
  document.getElementById("landingSection").style.display = "none";
  document.getElementById("sectionsSection").style.display = "block";

  // تنظيف شريط التبويبات ومحتوى الأقسام
  const tabs = document.getElementById("tabs");
  tabs.innerHTML = "";
  const sectionContent = document.getElementById("sectionContent");
  sectionContent.innerHTML = "";

  // جلب الأقسام من Firebase ومفلترة على "عطور"
  firebase.database().ref('categories').once('value', function(snapshot) {
    const categoriesData = snapshot.val() || {};
    const filteredNames = [];
    for (let key in categoriesData) {
      const name = categoriesData[key].name;
      if (name.includes("عطور")) {
        filteredNames.push(name);
      }
    }

    // إنشاء زر تبويب وقسم لكل فئة مفلترة
    filteredNames.forEach((name, idx) => {
      const dataTarget = 'perfumes_' + idx;
      // زر التبويب
      const btn = document.createElement('button');
      btn.className = 'tab';
      btn.setAttribute('data-target', dataTarget);
      btn.innerText = name;
      tabs.appendChild(btn);
      // مجموعة القسم
      const group = document.createElement('div');
      group.id = dataTarget;
      group.className = 'section-group';
      group.innerHTML = '<div class="section-buttons"></div>';
      sectionContent.appendChild(group);

      // حدث الضغط على التبويب
      btn.addEventListener('click', function() {
        document.querySelectorAll('#tabs .tab').forEach(t => t.classList.remove('active'));
        this.classList.add('active');
        document.querySelectorAll('#sectionContent .section-group').forEach(g => g.classList.remove('active'));
        group.classList.add('active');
      });
    });

    // تفعيل أول تبويب تلقائياً إذا وُجدت فئات
    if (filteredNames.length > 0) {
      tabs.querySelector('.tab').classList.add('active');
      sectionContent.querySelector('.section-group').classList.add('active');
    }

    // عرض المنتجات المناسبة داخل كل قسم
    (window.allProducts || [])
      .filter(p => p.category && filteredNames.includes(p.category))
      .forEach(prod => {
        const idx = filteredNames.indexOf(prod.category);
        const container = document.querySelector(`#perfumes_${idx} .section-buttons`);
        if (container) container.appendChild(createProductCard(prod));
      });

    // إعادة تهيئة سلوك التبويبات
    setupTabs();
  });
});


  // ----------------------------
  // عرض “أشهر العطور” مشابه لمنتجات العناية
  const popularBtn = document.getElementById("popularPerfumesBtn");
  popularBtn.addEventListener("click", function(e) {
    e.preventDefault();
    console.log("popularPerfumesBtn clicked"); // لتتأكد إنه يسمع الضغط

    // إخفاء landing وإظهار sections
    document.getElementById("landingSection").style.display = "none";
    document.getElementById("sectionsSection").style.display = "block";

    // إظهار شريط التبويبات (لو كان مخفي)
    document.getElementById("tabs-wrapper").style.display = "block";

    // تنظيف التبويبات والمحتوى
    const tabs = document.getElementById("tabs");
    const sectionContent = document.getElementById("sectionContent");
    tabs.innerHTML = "";
    sectionContent.innerHTML = "";

    // جلب الأقسام من Firebase وفّلترتها
    firebase.database().ref('categories').once('value', snapshot => {
      const data = snapshot.val() || {};
      const names = Object.values(data)
        .map(c => c.name)
        .filter(name => name.includes("عطور"));

      // أنشئ تبويب وقسم لكل اسم
      names.forEach((name, idx) => {
        const target = `perfumes_${idx}`;

        // زر التبويب
        const btn = document.createElement('button');
        btn.className = 'tab';
        btn.setAttribute('data-target', target);
        btn.innerText = name;
        tabs.appendChild(btn);

        // قسم المحتوى
        const grp = document.createElement('div');
        grp.id = target;
        grp.className = 'section-group';
        grp.innerHTML = '<div class="section-buttons"></div>';
        sectionContent.appendChild(grp);

        // حدث النقر
        btn.addEventListener('click', () => {
          document.querySelectorAll('#tabs .tab').forEach(t => t.classList.remove('active'));
          btn.classList.add('active');
          document.querySelectorAll('#sectionContent .section-group').forEach(g => g.classList.remove('active'));
          grp.classList.add('active');
        });
      });

      // فعل أول تبويب تلقائياً
      if (names.length) {
        tabs.querySelector('.tab').classList.add('active');
        sectionContent.querySelector('.section-group').classList.add('active');
      }

      // عرض المنتجات المفلترة
      (window.allProducts || [])
        .filter(p => p.category && names.includes(p.category))
        .forEach(prod => {
          const idx = names.indexOf(prod.category);
          const container = document.querySelector(`#perfumes_${idx} .section-buttons`);
          if (container) container.appendChild(createProductCard(prod));
        });

      // إعادة تشغيل setupTabs لضمان عمل التمرير والنشاط
      setupTabs();
    });
  });
  // ----------------------------
}; 







// ----------------------------
// Listener جديد لزر "أشهر العطور" يعتمد على DOMContentLoaded
document.addEventListener('DOMContentLoaded', function() {
  const popularBtn = document.getElementById('popularPerfumesBtn');
  if (!popularBtn) {
    console.error('popularPerfumesBtn غير موجود في DOM');
    return;
  }
  popularBtn.addEventListener('click', function(e) {
    e.preventDefault();
    console.log('تم الضغط على أشهر العطور'); // تأكد من ظهور هذه الرسالة في console

    // 1) إخفاء الهبوط وإظهار قسم الأقسام
    document.getElementById('landingSection').style.display = 'none';
    document.getElementById('sectionsSection').style.display = 'block';

    // 2) إظهار شريط التبويبات لو كان مخفيًّا
    document.getElementById('tabs-wrapper').style.display = 'block';

    // 3) تنظيف التبويبات ومحتوى الأقسام القديم
    const tabs = document.getElementById('tabs');
    const sectionContent = document.getElementById('sectionContent');
    tabs.innerHTML = '';
    sectionContent.innerHTML = '';

    // 4) جلب الفئات من Firebase وفلترة أسمائها على "عطور"
    firebase.database().ref('categories').once('value').then(snapshot => {
      const data = snapshot.val() || {};
      // مصفوفة أسماء الفئات التي تحوي "عطور"
      const filteredNames = Object.values(data)
        .map(cat => cat.name)
        .filter(name => name.includes('عطور'));

      // 5) بناء التبويبات ومجموعات المحتوى
      filteredNames.forEach((name, idx) => {
        const target = `perfumes_${idx}`;

        // زر التبويب
        const btn = document.createElement('button');
        btn.className = 'tab';
        btn.setAttribute('data-target', target);
        btn.innerText = name;
        tabs.appendChild(btn);

        // مجموعة المحتوى
        const grp = document.createElement('div');
        grp.id = target;
        grp.className = 'section-group';
        grp.innerHTML = '<div class="section-buttons"></div>';
        sectionContent.appendChild(grp);

        // حدث النقر على التبويب
        btn.addEventListener('click', () => {
          document.querySelectorAll('#tabs .tab').forEach(t => t.classList.remove('active'));
          btn.classList.add('active');
          document.querySelectorAll('#sectionContent .section-group').forEach(g => g.classList.remove('active'));
          grp.classList.add('active');
        });
      });

      // 6) تفعيل أول تبويب تلقائيًا إن وُجد
      if (filteredNames.length) {
        tabs.querySelector('.tab').classList.add('active');
        sectionContent.querySelector('.section-group').classList.add('active');
      }

      // 7) عرض المنتجات في القسم المناسب بناءً على الحقل category
      (window.allProducts || [])
        .filter(prod => prod.category && filteredNames.includes(prod.category))
        .forEach(prod => {
          const idx = filteredNames.indexOf(prod.category);
          const container = document.querySelector(`#perfumes_${idx} .section-buttons`);
          if (container) container.appendChild(createProductCard(prod));
        });

      // 8) إعادة تهيئة التمرير والنشاط للتبويبات
      setupTabs();
    }).catch(err => console.error('خطأ عند جلب categories:', err));
  });
});
// ----------------------------








  </script>
</head>
<body>
  <!-- Full-screen Background Video -->
  <video id="backgroundVideo" autoplay muted loop playsinline>
    <source src="https://screenpal.com/content/video/download/cTfvDonQo6P">
    Your browser does not support the video tag.
  </video>
  
  <!-- Full-screen Overlay -->
  <div id="overlay"></div>
  
  <!-- Loader Overlay for initial page load -->
  <div id="loader">
    <div class="spinner"></div>
  </div>
  
  <!-- Header (Fixed elements directly on background) -->
  <section id="headerSection">
    <div class="gpd-container">
      <div id="headerContent" class="gdp-row">
        <!-- Header Left: Social Media Buttons -->
        <div class="cell header-left">
          <div class="social-icons">
            <a href="https://www.instagram.com/mulberry.ps/" target="_blank" class="social-btn instagram">
              <img src="https://static.vecteezy.com/system/resources/thumbnails/042/148/632/small_2x/instagram-logo-instagram-social-media-icon-free-png.png" alt="Instagram"/>
            </a>
            <a href="https://www.facebook.com/profile.php?id=61571473259682&locale=ar_AR" target="_blank" class="social-btn facebook">
              <img src="https://static.vecteezy.com/system/resources/previews/050/616/503/non_2x/facebook-logo-in-white-circle-free-png.png" alt="Facebook"/>
            </a>
            <a href="https://www.tiktok.com/@mulberry.ps" target="_blank" class="social-btn tiktok">
              <img src="https://static.vecteezy.com/system/resources/previews/042/148/613/non_2x/tiktok-logo-tiktok-social-media-icon-free-png.png" alt="TikTok"/>
            </a>
          </div>
        </div>
        <!-- Header Center: Order Products Button (now "اطلب استشارة") and Lucky Wheel Button -->
        <div class="cell header-center" style="display: flex; justify-content: center; align-items: center;">
          <button id="orderProductsBtn" onclick="window.open('https://ig.me/m/mulberry.ps','_blank')">اطلب استشارة</button>
          <button id="luckyWheelBtn" onclick="openLuckyWheelModal()" style="background: transparent; border: none; width: 40px; height: 40px; margin-left: 10px; overflow: visible;">
            <img src="https://png.pngtree.com/png-vector/20221210/ourmid/pngtree-lucky-wheel-png-image_6518840.png" alt="Lucky Wheel Icon" style="width: 100%; height: 100%; object-fit: contain; transform-origin: center;"/>
          </button>
        </div>
        <!-- Header Right: Translation and Join Team Buttons -->
        <div class="cell header-right" style="display: flex; justify-content: flex-end;">
          
          <button id="joinTeamBtn" onclick="window.open('https://forms.gle/5tXHFwsgF6kycYG7A','_blank')">انضم إلى Mulberry Team</button>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Circular Dark Mode Button -->
  <button id="darkModeBtn">
    <img id="darkModeImg" src="https://cdn-icons-png.freepik.com/512/6714/6714978.png" alt="Dark Mode Toggle"/>
  </button>
  
  <!-- Main Content -->
  <main>
    <!-- Landing Section -->
    <section id="landingSection" class="gpd-section" data-anim-type="fadeIn">
      <div id="landing" style="position: relative; z-index: 2; padding: 60px; text-align: center;">
        <h1>Mulberry Store</h1>
        <p class="phrase">"حيث يلتقي الذوق الرفيع مع تجربة التسوق العصرية."</p>
        <p class="phrase">"اكتشف تشكيلتنا الكاملة والمميزة."</p>
        
  <div class="product-buttons-container">
  
<!-- زر لوازم المشاريع كبروكود -->
<a id="projectSuppliesBtn" href="javascript:void(0)" class="product-button">
  <div class="img-wrapper" style="background-image: url('https://mhhar.com/uploads/vendor/products/thumb/16162.jpg');"></div>
  <span class="btn-label">لوازم المشاريع</span>
</a>
<a class="product-button" id="shopNow" href="javascript:void(0)">
    <div class="img-wrapper" style="background-image: url('https://cdn.salla.sa/dogdz/48u2clVoA05TEJ4Lg7KI2L36Ctp9hKk7UDn6y6o3.jpg');"></div>
    <span class="btn-label">.منتجات. .العناية.</span>
  </a>
  <a href="#advertising" class="product-button">
    <div class="img-wrapper" style="background-image: url('https://i.pinimg.com/originals/d3/8c/56/d38c567bbcd46b56d3b0c4a75c29ac24.jpg');"></div>
    <span class="btn-label">الإعلان وجلسات التصوير</span>
  </a>


<!-- زر أشهر العطور -->
<a id="popularPerfumesBtn" href="javascript:void(0)" class="product-button">
  <div class="img-wrapper" style="background-image: url('https://cdn-1.hosting.anfa.media/upload/q_50/https://waheteter.com/wp-content/uploads/2023/08/Jean-Paul-Gaultier-Le-Male-Elixir2.jpg');"></div>
  <span class="btn-label">.أشهر. .العطور.</span>
</a>




</div>
 

        <div class="description" id="storeDescription">
          <p>
            مرحبًا بكم في Mulberry Store – المتجر الرائد الذي يقدم أفضل منتجات العناية بالبشرة، العناية الشخصية، باقات الهدايا والعطور الفاخرة.
            مهمتنا هي تقديم تجربة تسوق لا مثيل لها تجمع بين الجودة والراحة والابتكار في كل تفصيل.
          </p>
          <p>
            يعمل نظامنا الإلكتروني على تسهيل عملية الشراء: تصفح الأقسام المتنوعة، أضف منتجاتك المفضلة إلى سلة التسوق، وأكمل عملية الدفع عبر بوابات آمنة وسريعة.
            نحن ملتزمون بتقديم خدمة توصيل سريعة ودعم عملاء احترافي لضمان رضاكم التام.
          </p>
          <p>
            يهدف Mulberry Store إلى بناء علاقات دائمة مع عملائه من خلال توفير بيئة تسوق متميزة تجمع بين الأناقة والتكنولوجيا.
            تعرف على قصتنا وفريق العمل المبدع الذي يقف خلف كل منتج ونصيحة نقدمها لك.
          </p>
        </div>
      </div>
    </section>
    
    <!-- Extended Sections (Products Display) -->
    <section id="sectionsSection" class="gpd-section" data-anim-type="fadeIn">
      <div class="gpd-container">
        <div id="sections">
          <div class="back-container">
            <button onclick="goBack()">
              <svg viewBox="0 0 24 24">
                <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path>
              </svg>
            </button>
          </div>
          <div id="searchContainer">
            <input type="text" id="smartSearch" placeholder="ابحث عن القسم المناسب..."/>
            <div id="searchResults"></div>
          </div>
          <!-- شريط التبويبات للأقسام الثابتة والديناميكية مع شريط تمرير أعلى -->
          <div id="tabs-wrapper">
            <div id="tabs">
              <button class="tab active" data-target="general">عامة</button>
              <button class="tab" data-target="men">للرجال</button>
              <button class="tab" data-target="women">للنساء</button>
              <button class="tab" data-target="other">اخرى</button>
            </div>
          </div>
          <div id="sectionContent">
            <!-- الأقسام الثابتة -->
            <div id="general" class="section-group active">
              <div id="generalSections" class="section-buttons"></div>
            </div>
            <div id="men" class="section-group">
              <div id="menSections" class="section-buttons"></div>
            </div>
            <div id="women" class="section-group">
              <div id="womenSections" class="section-buttons"></div>
            </div>
            <div id="other" class="section-group">
              <div id="otherSections" class="section-buttons"></div>
            </div>
            <!-- الأقسام الجديدة (الديناميكية) سيتم إضافتها هنا من خلال Firebase -->
          </div>
          <div id="extendedInfo">
            <p>حول Mulberry Store وفريق العمل</p>
            <p>
              يتميز Mulberry Store بشغفه الدائم نحو تقديم أفضل المنتجات والخدمات لعملائه.
              يجمع المتجر بين خبرة فريق متخصص ورؤية واضحة نحو التميز والابتكار في عالم الجمال والعناية.
            </p>
            <p>
              نعمل على تحديث مجموعتنا باستمرار، وتقديم محتوى تثقيفي ونصائح قيمة تساعدك على اختيار المنتجات المثالية.
              كما نحرص على خلق تجربة تسوق تفاعلية تجمع بين الأناقة وسهولة الاستخدام.
            </p>
          </div>
        </div>
      </div>
    </section>
  </main>
  
  <!-- Modal for Product Sections -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <div id="modalLoader">
        <div class="spinner"></div>
      </div>
      <span class="close" onclick="closeModal()">&times;</span>
      <iframe id="sectionFrame" src=""></iframe>
      <br/>
      <button class="close-btn" onclick="closeModal()">Close</button>
    </div>
  </div>
  
  <!-- Modal for Product Details -->
  <div id="productModal" class="modal">
    <div class="modal-content" style="background: #fff; padding: 20px; border-radius: 15px; max-width: 600px; margin: 100px auto; position: relative;">
      <span class="close" id="productModalClose" onclick="closeProductModal()">&times;</span>
      <img id="productModalImage" src="" alt="Product Image" style="width: 100%; max-height:300px; object-fit: contain; margin-bottom: 20px;" />
      <h3 id="productModalName"></h3>
      <p id="productModalPrice"></p>
      <p id="productModalDescription"></p>
      <button id="productModalCloseBtn" class="close-btn" onclick="closeProductModal()">Close</button>
    </div>
  </div>
  
  <!-- Modal for Lucky Wheel -->
  <!-- سيتم إضافته ديناميكيًا عبر دالة openLuckyWheelModal() -->
  
  <!-- JavaScript Logic -->
  <script>

const currentLanguage = 'ar';           // نعيد تعريف اللغة الافتراضية
  const sectionTranslations = {};

    // نقوم بتعريف كائن لتخزين روابط الأقسام الديناميكية من Firebase
    let firebaseCategoryMap = {};
    
    // دالة إنشاء بطاقة المنتج مع تعديل كلمة "ريال" إلى "شيكل" وإضافة حدث النقر لفتح نافذة تفاصيل المنتج
    function createProductCard(product) {
      const card = document.createElement("div");
      card.className = "product-card";
      card.innerHTML = `
        <img src="${product.image}" alt="${product.name}" />
        <h3>${product.name}</h3>
        <p>السعر: ${product.price} شيكل</p>
      `;
      card.addEventListener("click", function() {
        openProductModal(product);
      });
      return card;
    }
    
    window.onload = function() {
      const loader = document.getElementById("loader");
      loader.style.opacity = 0;
      setTimeout(() => { loader.style.display = "none"; }, 500);
      
      
      
      const darkModeBtn = document.getElementById("darkModeBtn");
      const backgroundVideo = document.getElementById("backgroundVideo");
      darkModeBtn.addEventListener("click", function() {
        document.documentElement.classList.toggle("dark-mode");
        const darkModeImg = document.getElementById("darkModeImg");
        if(document.documentElement.classList.contains("dark-mode")){
          darkModeImg.src = "https://assets.streamlinehq.com/image/private/w_240,h_240,ar_1/f_auto/v1/icons/flash/light-dark-mode-e3gg3irc1eguseoto21y3o.png/light-dark-mode-886e8g3i55i69jhfuguoa2.png?_a=DAJFJtWIZAAC";
          darkModeImg.alt = "Light Mode Toggle";
          backgroundVideo.querySelector("source").src = "https://screenpal.com/content/video/download/cTfvDonQo6P";
        } else {
          darkModeImg.src = "https://cdn-icons-png.freepik.com/512/6714/6714978.png";
          darkModeImg.alt = "Dark Mode Toggle";
          backgroundVideo.querySelector("source").src = "https://screenpal.com/content/video/download/cTfvDonQo6P";
        }
        backgroundVideo.load();
window.onload = function() {
  // … الكود الحالي
};

      });
      
      window.addEventListener("scroll", function() {
        const header = document.getElementById("headerSection");
        if (window.pageYOffset > 50) {
          header.classList.add("scrolled");
        } else {
          header.classList.remove("scrolled");
        }
      });
      
      
      
      // البيانات المحلية للأقسام الثابتة
      const mensSections = [
        { name: "عطور للرجال", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=59" },
        { name: "عطور", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=5" },
        { name: "مزيلات عرق للرجال", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=74" },
        { name: "منتجات العناية للرجال", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=115" },
        { name: "منتجات الحلاقة للرجال", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=69" },
        { name: "البشرة والوجه", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=14" },
        { name: "مرطبات وكريمات للوجه", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=50" },
        { name: "معالجات وسيروم للوجه", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=54" },
        { name: "العناية بالفم", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=114" },
        { name: "العناية بالأسنان", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=129" },
        { name: "الوقاية من الشمس والتسمير", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=17" },
        { name: "العناية بالشعر", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=4" },
        { name: "شامبو", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=61" },
        { name: "سيروم وزيوت للشعر", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=63" },
        { name: "غسولات", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=158" },
        { name: "تصفيف الشعر", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=64" }
      ];
      
      const womensSections = [
        { name: "العناية بالجسم", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=3" },
        { name: "مرطب للجسم", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=56" },
        { name: "البشرة والوجه", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=14" },
        { name: "مرطبات وكريمات للوجه", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=50" },
        { name: "معطر للجسم", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=150" },
        { name: "مقشرات وملمعات الجسم", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=68" },
        { name: "مستلزمات العناية الشخصية", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=113" },
        { name: "معالجات وسيروم للوجه", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=54" },
        { name: "العناية باليدين", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=55" },
        { name: "صابون استحمام", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=66" },
        { name: "النظافة الشخصية للنساء", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=72" },
        { name: "العناية بالقدم", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=67" },
        { name: "عطور", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=5" },
        { name: "عطور للنساء", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=58" },
        { name: "تفتيح", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=48" },
        { name: "منتجات تفتيح الجسم", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=135" },
        { name: "مزيلات عرق للنساء", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=73" },
        { name: "العناية بالحامل والمرضعة", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=16" },
        { name: "إزالة الشعر", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=80" },
        { name: "العناية بالفم", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=114" },
        { name: "العناية بالأسنان", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=129" },
        { name: "الوقاية من الشمس والتسمير", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=17" },
        { name: "الوجه", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=25" },
        { name: "أقنعة الوجه", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=40" },
        { name: "منظفات البشرة", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=65" },
        { name: "تقشير البشرة", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=42" },
        { name: "العناية بالشفاه", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=41" },
        { name: "الشفاه", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=51" },
        { name: "العناية بالعين", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=71" },
        { name: "تونرات", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=70" },
        { name: "الرموش", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=34" },
        { name: "المكياج", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=12" },
        { name: "فيتامينات", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=116" }
      ];
      
      const othersSections = [
        { name: "صابون اليدين", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=81" },
        { name: "العناية بالفم", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=114" },
        { name: "العناية بالأسنان", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=129" },
        { name: "المنزل", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=75" },
        { name: "مستلزمات المطبخ", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=76" },
        { name: "مستلزمات المنزل", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=122" },
        { name: "مستلزمات الأطفال", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=53" },
        { name: "إكسسوارات الحمام", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=147" },
        { name: "عطور منزلية", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=127" },
        { name: "اكسسوارات منزلية", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=123" },
        { name: "أدوات كهربائية", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=148" },
        { name: "مستلزمات التنظيف", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=78" },
        { name: "فيتامينات", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=116" },
        { name: "مناديل التنظيف", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=49" },
        { name: "البكجات والعروض", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=79" },
        { name: "عناية بالطفل", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=154" },
        { name: "كتب", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=166" },
        { name: "🌙تُحف رمضانية", link: "https://d3cfvw9kavtabe.cloudfront.net/shops/nada/explorer?categoryId=128" }
      ];
      
      const generalSectionsArray = [...mensSections, ...womensSections, ...othersSections];
      
      // دوال الأقسام الأصلية لإنشاء أزرار (إن كانت لازالت مستخدمة)
      function generateSectionImage(textToDraw) {
        const canvas = document.createElement("canvas");
        canvas.width = 130;
        canvas.height = 130;
        const ctx = canvas.getContext("2d");
        let hash = 0;
        for (let i = 0; i < textToDraw.length; i++) {
          hash = textToDraw.charCodeAt(i) + ((hash << 5) - hash);
        }
        let hue1 = Math.abs(hash) % 360;
        let hue2 = (hue1 + 60) % 360;
        let gradient = ctx.createLinearGradient(0, 0, 130, 130);
        gradient.addColorStop(0, `hsl(${hue1}, 70%, 50%)`);
        gradient.addColorStop(1, `hsl(${hue2}, 70%, 50%)`);
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, 130, 130);
        ctx.fillStyle = "rgba(255,255,255,0.2)";
        ctx.beginPath();
        ctx.arc(65, 65, 35, 0, 2 * Math.PI);
        ctx.fill();
        ctx.fillStyle = "#fff";
        ctx.font = "bold 14px Poppins";
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";
        ctx.fillText(textToDraw, 65, 65);
        return canvas.toDataURL();
      }
      
      function createLayeredButton(section) {
        const btn = document.createElement("div");
        btn.className = "section-button";
const displayText = section.name;   // نستخدم اسم القسم مباشرة
        const imageUrl = generateSectionImage(displayText);
        const bgImage = document.createElement("div");
        bgImage.className = "bg-image";
        bgImage.style.backgroundImage = "url('" + imageUrl + "')";
        const overlay = document.createElement("div");
        overlay.className = "overlay";
        const text = document.createElement("div");
        text.className = "text";
        text.innerText = displayText;
        btn.appendChild(bgImage);
        btn.appendChild(overlay);
        btn.appendChild(text);
        btn.addEventListener("click", function () { openModal(section.link); });
        return btn;
      }
      
      function createSectionButtons(containerId, sections) {
        const container = document.getElementById(containerId);
        container.innerHTML = "";
        sections.forEach((section) => {
          const btn = createLayeredButton(section);
          container.appendChild(btn);
        });
      }
      
      function openModal(link) {
        document.getElementById("modalLoader").style.display = "flex";
        document.getElementById("sectionFrame").src = link;
        document.getElementById("modal").style.display = "block";
      }
      function closeModal() {
        document.getElementById("modal").style.display = "none";
        document.getElementById("sectionFrame").src = "";
      }
      window.closeModal = closeModal;
      
      document.getElementById("sectionFrame").addEventListener("load", function() {
        document.getElementById("modalLoader").style.display = "none";
      });
      
      window.addEventListener("click", function (event) {
        if (event.target === document.getElementById("modal")) { closeModal(); }
      });
      
      function setupTabs() {
        const tabs = document.querySelectorAll("#tabs .tab");
        tabs.forEach((tab) => {
          tab.addEventListener("click", function () {
            tabs.forEach((t) => t.classList.remove("active"));
            this.classList.add("active");
            const target = this.getAttribute("data-target");
            document.querySelectorAll("#sectionContent .section-group").forEach((group) => {
              group.classList.remove("active");
            });
            document.getElementById(target).classList.add("active");
            // تمرير التبويب الذي تم الضغط عليه ليصبح أول زر ظاهر داخل القائمة
            this.scrollIntoView({ behavior: "smooth", inline: "start" });
          });
        });
      }
      
      // دالة تحميل الأقسام الجديدة من Firebase من العقدة "categories"
      function loadFirebaseCategories() {
        firebase.database().ref('categories').on('value', function(snapshot) {
          const categoriesData = snapshot.val();
          if (categoriesData) {
            for (let key in categoriesData) {
              if (categoriesData.hasOwnProperty(key)) {
                const category = categoriesData[key];
                const dataTarget = "cat_" + key;
                // إنشاء زر تبويب جديد بنفس نمط الأزرار الثابتة
                const newTab = document.createElement("button");
                newTab.className = "tab";
                newTab.setAttribute("data-target", dataTarget);
                newTab.innerText = category.name;
                document.getElementById("tabs").appendChild(newTab);
                
                // إنشاء القسم المطابق لعرض محتوى هذا التبويب
                const newSectionGroup = document.createElement("div");
                newSectionGroup.id = dataTarget;
                newSectionGroup.className = "section-group";
                newSectionGroup.innerHTML = `<div class="section-buttons"></div>`;
                document.getElementById("sectionContent").appendChild(newSectionGroup);
                
                // حفظ الربط بين اسم القسم ومعرف القسم الجديد
                firebaseCategoryMap[category.name] = dataTarget;
                
                // إضافة حدث النقر للزر الجديد لتفعيل عرض القسم الخاص به
                newTab.addEventListener("click", function() {
                  document.querySelectorAll("#tabs .tab").forEach(function(tab) {
                    tab.classList.remove("active");
                  });
                  this.classList.add("active");
                  document.querySelectorAll("#sectionContent .section-group").forEach(function(group) {
                    group.classList.remove("active");
                  });
                  document.getElementById(dataTarget).classList.add("active");
                  this.scrollIntoView({ behavior: "smooth", inline: "start" });
                });
              }
            }
          }
        });
      }
      
      // دالة تحميل المنتجات من Firebase من العقدة "products" وعرضها حسب القسم
      function loadProducts() {
        firebase.database().ref('products').on('value', function(snapshot) {
          // إعادة تعيين مصفوفة المنتجات العالمية
          window.allProducts = [];
          // تفريغ الحاويات الحالية للمنتجات في الأقسام الثابتة والديناميكية
          document.getElementById("generalSections").innerHTML = "";
          document.getElementById("menSections").innerHTML = "";
          document.getElementById("womenSections").innerHTML = "";
          document.getElementById("otherSections").innerHTML = "";
          // تفريغ الحاويات للأقسام الجديدة
          for (let cat in firebaseCategoryMap) {
            const container = document.querySelector("#" + firebaseCategoryMap[cat] + " .section-buttons");
            if(container) { container.innerHTML = ""; }
          }
          
          const productsData = snapshot.val();
          if (productsData) {
            for (let key in productsData) {
              if (productsData.hasOwnProperty(key)) {
                const product = productsData[key];
                // إضافة المنتج إلى مصفوفة المنتجات العالمية
                window.allProducts.push(product);
                let container;
                // تحديد الحاوية المناسبة بناءً على قيمة product.category
                if (product.category === "عامة") {
                  container = document.querySelector("#generalSections");
                } else if (product.category === "للرجال") {
                  container = document.querySelector("#menSections");
                } else if (product.category === "للنساء") {
                  container = document.querySelector("#womenSections");
                } else if (product.category === "اخرى" || product.category === "أخرى") {
                  container = document.querySelector("#otherSections");
                } else if (firebaseCategoryMap[product.category]) {
                  container = document.querySelector("#" + firebaseCategoryMap[product.category] + " .section-buttons");
                }
                // إذا لم يتم تحديد حاوية، نضعها في قسم "عامة" كافتراضي
                if (!container) {
                  container = document.querySelector("#generalSections");
                }
                const card = createProductCard(product);
                container.appendChild(card);
              }
            }
          }
        });
      }
      
      // استدعاء تحميل الأقسام والمنتجات من Firebase
      /*loadFirebaseCategories();*/
      loadProducts();














      
      // تعديل دالة البحث لتشمل الأقسام والمنتجات من قاعدة البيانات
      document.getElementById("smartSearch").addEventListener("input", function () {
        const query = this.value.trim().toLowerCase();
        const resultsContainer = document.getElementById("searchResults");
        resultsContainer.innerHTML = "";
        if (query.length > 0) {
          let resultsFound = false;
          // البحث في الأقسام الثابتة
          const allSections = generalSectionsArray;
          allSections.forEach((section) => {
            let displayName = currentLanguage === "en" && sectionTranslations[section.name] ? sectionTranslations[section.name] : section.name;
            if (displayName.toLowerCase().indexOf(query) !== -1) {
              resultsFound = true;
              const resultBtn = createLayeredButton(section);
              resultsContainer.appendChild(resultBtn);
            }
          });
          // البحث في المنتجات المضافة من قاعدة البيانات
          if (window.allProducts && Array.isArray(window.allProducts)) {
            window.allProducts.forEach(product => {
              if (product.name.toLowerCase().indexOf(query) !== -1) {
                resultsFound = true;
                const productCard = createProductCard(product);
                resultsContainer.appendChild(productCard);
              }
            });
          }
          if (!resultsFound) { resultsContainer.innerHTML = "<p>لا توجد نتائج مطابقة.</p>"; }
        }
      });
      
      document.getElementById("shopNow").addEventListener("click", function (event) {
  event.preventDefault();  // يمنع الانتقال الافتراضي للـ<a>
        document.getElementById("landingSection").style.display = "none";
        document.getElementById("sectionsSection").style.display = "block";
        // إنشاء أزرار الأقسام الأصلية
        createSectionButtons("generalSections", generalSectionsArray);
        createSectionButtons("menSections", mensSections);
        createSectionButtons("womenSections", womensSections);
        createSectionButtons("otherSections", othersSections);
        setupTabs();
      });
      
      window.goBack = function () {
        if (document.getElementById("sectionsSection").style.display === "block") {
          document.getElementById("sectionsSection").style.display = "none";
          document.getElementById("landingSection").style.display = "block";
        } else {
          window.history.back();
        }
      };
      
      

      // دوال لعجلة الحظ (Lucky Wheel Modal)
      window.openLuckyWheelModal = function() {
        var modalHtml = `
          <div id="luckyWheelModal" class="modal">
            <div class="modal-content">
              <span class="close" onclick="closeLuckyWheelModal()">&times;</span>
              <iframe src="https://mulberryteam.github.io/mulberrywheel/" frameborder="0" style="border:none; border-radius:8px;"></iframe>
              <button class="close-lucky-btn" onclick="closeLuckyWheelModal()">
                <i class="fa fa-sign-out-alt"></i> خروج
              </button>
            </div>
          </div>
        `;
        document.body.insertAdjacentHTML('beforeend', modalHtml);
        document.getElementById("luckyWheelModal").style.display = "flex";
      };

      window.closeLuckyWheelModal = function() {
        var modal = document.getElementById("luckyWheelModal");
        if(modal) {
          modal.parentNode.removeChild(modal);
        }
      };

      // دوال النافذة المنبثقة لتفاصيل المنتج
      window.openProductModal = function(product) {
        document.getElementById("productModalImage").src = product.image;
        document.getElementById("productModalName").innerText = product.name;
        document.getElementById("productModalPrice").innerText = "السعر: " + product.price + " شيكل";
        document.getElementById("productModalDescription").innerText = product.description;
        document.getElementById("productModal").style.display = "block";
      };

      window.closeProductModal = function() {
        document.getElementById("productModal").style.display = "none";
      };
    };






// عند النقر على زر لوازم المشاريع: نستخدم نفس واجهة sectionsSection
document.getElementById("projectSuppliesBtn").addEventListener("click", function(event) {
  event.preventDefault();

  // 1) إخفاء landing
  document.getElementById("landingSection").style.display = "none";
  // 2) إظهار sectionsSection
  document.getElementById("sectionsSection").style.display = "block";

  // 3) إخفاء شريط التبويبات (tabs) لأننا نعرض فئة واحدة فقط
  document.getElementById("tabs-wrapper").style.display = "none";

  // 4) تفريغ حاويات المنتجات الثابتة (القسم العام)
  const generalContainer = document.getElementById("generalSections");
  generalContainer.innerHTML = "";

  // 5) فلترة منتجات "لوازم المشاريع" من allProducts
  const filtered = (window.allProducts || []).filter(p =>
    p.category && p.category.includes("لوازم المشروع")
  );

  // 6) إذا لا توجد منتجات
  if (filtered.length === 0) {
    generalContainer.innerHTML = "<p>لا توجد منتجات في هذه الفئة.</p>";
  } else {
    // 7) عرض كل منتج باستخدام createProductCard (نفس تصميم بطاقات العناية)
    filtered.forEach(prod => {
      const card = createProductCard(prod);
      generalContainer.appendChild(card);
    });
  }
});






  </script>













</body>
</html>
